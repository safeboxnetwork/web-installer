<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safebox</title>
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #000000;
            --app-bg: #f0f0f0;
            --button-border: #000000;
        }
        [data-theme="dark"] {
            --bg-color: #1a1a1a;
            --text-color: #ffffff;
            --app-bg: #2c2c2c;
            --button-border: #ffffff;
        }
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
        }
	table {border: 1px solid orange; width:100%;}
	table th {padding-left: 20px; text-align: left; color: orange; width: 25%;}
	table td {padding-left: 20px; text-align:left; width: 25%;}

	label {text-align: left !important;}
	a, a:hover, a:visited {color: orange}

	fieldset {border: 1px solid  #ffffff; padding-left: 20px; padding-right: 20px; border-radius: 10px;}
	legend {width: auto;text-align: left !important; padding: 10px; color: #ffffff;}

        .profile {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-weight: bold;
            gap: 5px;
            cursor: pointer;
        }
        .profile img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 50%;
        }
        .settings {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-weight: bold;
            gap: 5px;
        }
        .logo {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .logo img {
            width: 50px;
            height: 50px;
        }
        .logo div {
            margin: 0;
            padding: 0;
        }
        .logo h1 {
            margin: 0;
            padding: 0;
            font-size: 24px;
	    color: var(--text-color);
        }
        .toggle {
            cursor: pointer;
            width: 40px;
            height: 20px;
            border: 1px solid var(--button-border);
            border-radius: 10px;
            position: relative;
        }
        .toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 16px;
            height: 16px;
            background: var(--button-border);
            border-radius: 50%;
            transition: 0.3s;
        }
        .toggle.active::after {
            transform: translateX(20px);
        }
        div#themeToggle {
		position: fixed;
		top: 10px;
		right: 10px;
        }
        .buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            cursor: pointer;
        }
        .buttons button {
            min-width: 150px;
            padding: 10px 10px;
            background: none;
            border: 1px solid var(--button-border);
            border-radius: 10px;
            cursor: pointer;
            color: var(--text-color);
        }
        .buttons button.active, .buttons button:hover {
		color: orange;
            	border: 1px solid orange;
        }
        .container {
		clear:both;
		float:none;
		border: 1px solid;
            	border-radius: 10px;
		padding-bottom: 10px;
		margin: 5px;
        }
        .leftside {
		float:left;
		width:20%;
        }
        .rightside {
		float:right;
		width:80%;
		display: flex;
		flex-direction: column;
		height: 88vh;
        }
        .my-apps {
            flex: 1;
            background-color: var(--app-bg);
            padding: 40px;
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 40px;
            min-width: 92%;
            max-width: 92%;
            margin: 0 auto;
            border-radius: 10px;
            box-sizing: border-box;
        }
        .my-apps-container {
            width:100%;
            display: flex;
            flex-wrap: wrap;
        }
        .app {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 120px;
            cursor: pointer;
        }
        .app img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 10px;
        }
        .innerDiv {
            width:100%;
        }
        footer {
	    position: fixed;
	    bottom: 0;
	    left: 0;
	    width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            font-size: 14px;
	    z-index: 1000;
	}
        .footer-links {
            display: flex;
            gap: 15px;
        }
        .footer-links a {
            color: black;
            text-decoration: none;
            font-weight: bold;
        }
        .footer-center {
            text-align: center;
        }
        .footer-center p {
            margin: 5px 0;
        }
        .footer-center strong {
            font-size: 18px;
        }
        .footer-center a {
            color: var(--text-color);
            text-decoration: none;
            font-weight: bold;
        }
        .footer-center a:hover {
            text-decoration: underline;
        }
        .footer-social {
            display: flex;
            gap: 15px;
        }
        .footer-social a {
            color: black;
            text-decoration: none;
            font-weight: bold;
        }
        .hidden {
            display: none;
        }

        .popup.hidden {
            display: none;
        }

        .popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999;
        }

        .popup-content {
            background: var(--bg-color);
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            text-align: left;
            position: relative;
            animation: fadeIn 0.3s ease;
        }

        .popup-content .close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
        }

        [data-theme="dark"] .footer-links a,
        [data-theme="dark"] .footer-social a {
            color: white;
        }

        [data-theme="dark"] .footer-links a:hover,
        [data-theme="dark"] .footer-social a:hover {
            text-decoration: underline;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .input-group {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
        }

        .input-group input {
		min-width:260px;
            margin-top: 5px;
            margin-bottom: 5px;
            padding: 5px;
            border: 1px solid var(--button-border);
            border-radius: 10px;
            background: none;
            color: var(--text-color);
            outline: none;
        }

        .input-group button {
            padding: 10px 20px;
            background: none;
            border: 1px solid var(--button-border);
            border-radius: 10px;
            color: var(--text-color);
            cursor: pointer;
        }

        .checkbox-container {
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  font-size: 16px;
  user-select: none;
  color: var(--text-color);
  position: relative;
}

.checkbox-container input {
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
}

.checkmark {
  position: relative;
  height: 24px;
  width: 24px;
  background-color: var(--app-bg);
  border: 2px solid var(--button-border);
  border-radius: 6px;
  box-sizing: border-box;
  transition: background-color 0.3s, border-color 0.3s;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* Ha be van pipálva: sötét hátteret és világos szegélyt */
.checkbox-container input:checked ~ .checkmark {
  background-color: var(--button-border);
  border-color: var(--button-border);
}

/* A pipa - kisebb és középen */
.checkmark::after {
  content: "";
  display: block;
  width: 10px;
  height: 6px;
  border: solid var(--bg-color);
  border-width: 0 0 3px 3px;
  transform: rotate(-45deg);
  opacity: 0;
  transition: opacity 0.3s;
}

/* Ha be van jelölve: megjelenik a pipa */
.checkbox-container input:checked ~ .checkmark::after {
  opacity: 1;
}

/* Dark mode variációk */
[data-theme="dark"] {
  --bg-color: #1a1a1a;
  --text-color: #f0f0f0;
  --app-bg: #2c2c2c;
  --button-border: #e0e0e0;
}


        .custom-select {
            padding: 10px;
            border: 1px solid var(--button-border);
            border-radius: 10px;
            background-color: var(--app-bg);
            color: var(--text-color);
            font-size: 16px;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='10' viewBox='0 0 14 10'%3E%3Cpolyline points='1 1 7 7 13 1' style='fill:none;stroke:black;stroke-width:2' /%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 12px;
        }

        [data-theme="dark"] .custom-select {
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='10' viewBox='0 0 14 10'%3E%3Cpolyline points='1 1 7 7 13 1' style='fill:none;stroke:white;stroke-width:2' /%3E%3C/svg%3E");
        }


        #popup .input-group {
            display: block;
        }

        #popup .row {
            display: flex;
        }

	.info-container {
		position: relative;
		display: inline-block;
		font-family: Arial, sans-serif;
		margin: 5px 0px 0px 5px;
	}

    .info-icon {
      background-color: #007BFF;
      color: white;
      border-radius: 50%;
      padding: 4px 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
      text-align: center;
      line-height: 1;
      display: inline-block;
    }

    .tooltip {
      visibility: hidden;
      background-color: #333;
      color: #fff;
      text-align: left;
      border-radius: 4px;
      padding: 8px;
      position: absolute;
      z-index: 1;
      bottom: 125%; /* above the icon */
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      white-space: nowrap;
    }

    .tooltip::after {
      content: "";
      position: absolute;
      top: 100%; /* bottom of tooltip */
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #333 transparent transparent transparent;
    }

    .info-container:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 10px;
            }

            .buttons {
                flex-direction: column;
                align-items: center;
            }

            .buttons button {
                width: 80%;
            }

            .my-apps {
                min-width: 75%;
                max-width: 75%;
                padding: 20px;
                justify-content: center;
                flex-direction: column;
                text-align: center;
                align-items: center;
            }

            .app {
                width: 80px;
            }

            footer {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .footer-links, .footer-social {
                justify-content: center;
            }
            .input-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .input-group input,
            .input-group button,
            .input-group select,
            .checkbox-container {
                width: 100%;
            }
        }
    </style>
</head>
<body>

<div class="container">
<div class="leftside">
    <div class="logo">
        <img src="image.png" alt="Logo">
        <div>
		<h1>Safebox</h1>
	</div>
    </div>
    <div class="profile" id="profileSection">
	<!--<img src="image.png" alt="Profilkép">-->
        <div id="vpnBtn">Pro</div>
    </div>
    <div style="text-align:center">
	Proxy&nbsp;status
	<span id="vpn_on" class="hidden green"><b>ON</b></span>
	<span id="vpn_off" class="hidden red"><b>OFF</b></span>
    </div>
	<div class="buttons">
	 	<button id="servicesBtn">Services</button>
	</div>
    	<div class="settings">Settings</div>
	<div class="buttons">
		<button id="updatesBtn">Updates</button>
	</div>
	<div class="buttons">
		<button id="repositoriesBtn">Repositories</button>
	</div>
	<div class="buttons">
		<button id="systemservicesBtn">System services</button>
	</div>
	<br>
	<br>
		<div style="text-align:center;">
		<a href="manage2.html" id="refresh_btn">REFRESH</a>
		<br>
		<br>
		<a href="manage.html" id="old_btn">OLD DESIGN</a>
		</div>
</div>

<div class="rightside">
	<div class="buttons">
	    <button id="myAppsBtn">My Apps</button>
	    <button id="installAppsBtn">Install Apps</button>
	    <button id="backupBtn">Backup</button>
	    <button id="diskBtn">Disk Management</button>
	    <button id="monitorBtn">Monitor</button>
	    <div class="toggle" id="themeToggle"></div>
	</div>

	<div class="my-apps"><div id="myAppsContainer" class="my-apps-container"></div></div>
</div>
</div>

<div id="popup" class="popup hidden">
  <div class="popup-content">
    <span class="close">&times;</span>
    <div class="input-group">
    <div id="popupText" class="deployment">Load app template here</div>
    </div>
  </div>
</div>
<footer>
    <div class="footer-links">
        <a href="#">Help</a>
        <a href="#">Docs</a>
        <a href="#">Report</a>
    </div>

    <div class="footer-center">
        <p>Want to access your services remotely?</p>
        <p><strong><a href="#">Go Pro!</a></strong></p>
    </div>

    <div class="footer-social">
        <a href="#">Discord</a>
        <a href="#">X</a>
    </div>
</footer>

<script>
    const toggle = document.getElementById('themeToggle');
    toggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        if (currentTheme === 'dark') {
            document.documentElement.removeAttribute('data-theme');
        } else {
            document.documentElement.setAttribute('data-theme', 'dark');
        }
        toggle.classList.toggle('active');
    });
    // default dark
    document.documentElement.setAttribute('data-theme', 'dark');
</script>

<script>
    // apps array beállítása common.js-ben
    const apps = []; // GLOBAL VARIABLE

    document.addEventListener('DOMContentLoaded', function() {

    const myAppsBtn = document.getElementById('myAppsBtn');
    const installAppsBtn = document.getElementById('installAppsBtn');
    const backupBtn = document.getElementById('backupBtn');
    const diskBtn = document.getElementById('diskBtn');
    const monitorBtn = document.getElementById('monitorBtn');

    const vpnBtn = document.getElementById('vpnBtn');
    const servicesBtn = document.getElementById('servicesBtn');
    const updatesBtn = document.getElementById('updatesBtn');
    const repositoriesBtn = document.getElementById('repositoriesBtn');
    const systemservicesBtn = document.getElementById('systemservicesBtn');

    const myAppsContainer = document.getElementById('myAppsContainer');
    const popup = document.getElementById('popup');
    const popupText = document.getElementById('popupText');
    const closeBtn = document.querySelector('.close');

    //Appok betöltése
    function renderApps(all) {
        myAppsContainer.innerHTML = '';
        apps.forEach(app => {
	    if ((all==false && app.installed=='true') || (all==true && app.installed!='true')) {
		    const appDiv = document.createElement('div');
		    appDiv.className = 'app';
		    appDiv.innerHTML = `
			<img src="${app.image}" alt="${app.name}" title="${app.orig_name} ${app.version}">${app.orig_name}
		    `;
		    appDiv.addEventListener('click', () => {
			    popupText.textContent = `You clicked on ${app.name} ${app.version}!`;
			if (app.installed=='true') reinstall(app.name, 'popupText');
			else load_template(app.name,'popupText');
			popup.classList.remove('hidden');
		    });
		    myAppsContainer.appendChild(appDiv);
            }
        });
    }

    //TODO: Ilyen függvényeket kell csinálni és a listenerekhez adni az egyes részeket
    function renderText(title) {
        //TODO: itt kell a buttont editálni és így kell hozzáadni hozzá mindent
        myAppsContainer.innerHTML = `
            <h1 style="text-align: center;">${title}</h1>

            <div class="input-group">
                <input type="text" placeholder="Írj be valamit..." id="textInput">
                <button id="submitButton">Küldés</button>

                <select id="myComboBox" class="custom-select">
                    <option value="">Válassz egy lehetőséget...</option>
                    <option value="1">Első opció</option>
                    <option value="2">Második opció</option>
                    <option value="3">Harmadik opció</option>
                </select>

                <label class="checkbox-container">
                    <input type="checkbox" id="myCheckbox">
                    <span class="checkmark"></span>
                    Elfogadom a feltételeket
                </label>
            </div>
        `;

        const submitButton = document.getElementById('submitButton');
        const textInput = document.getElementById('textInput');

        if (submitButton && textInput) {
            submitButton.addEventListener('click', () => {
                const value = textInput.value.trim();
                if (value) {
                    alert(`Beírt szöveg: ${value}`);
                    textInput.value = '';
                } else {
                    alert('Kérlek írj be valamit!');
                }
            });
        }
    }

    function renderVPN() {
        myAppsContainer.innerHTML = `
            <div id="vpn" class="innerDiv">
	    Loading...
            </div>
        `;
	get_proxy_html();
    }

    function renderServices() {
        myAppsContainer.innerHTML = `
            <div id="services" class="innerDiv">
	    Loading...
            </div>
        `;
	get_services();
    }

    function renderUpdates() {
        myAppsContainer.innerHTML = `
            <div id="updates" class="innerDiv">
	    Looking for updates... Please wait...
            </div>
        `;
	get_updates();
    }

    function renderRepositories() {
        myAppsContainer.innerHTML = `
        <div class="input-group">
	<fieldset>
	<legend>Repositories</legend>
		<div id="repositories" style="text-align:left">Loading...</div>

		<hr>
		<form class="form-install" action="#" method="post" id="add_repo">
		<div class="row">
		    <div class="mb-3" style="text-align:left">
			<label for="registry">Please add a new GIT repository URL: </label>
			<input type="registry" class="form-control" name="repository" id="repository" size="100" value="" required>
			<div class="invalid-feedback">
			Please enter a valid repository url.
			</div>
		    </div>
		</div>
		<div class="row">
		    <div class="mb-3">
			<button class="btn btn-lg btn-primary btn-block" type="submit" id="repo_add_btn"> Add </button>
		    </div>
		</div>
		</form>
	</fieldset>
	</div>
        `;
    }

    function renderSystemServices() {
        myAppsContainer.innerHTML = `
            <div id="system">
	    Loading...
            </div>
        `;
	get_system();
    }

	function activate(btn) {
		myAppsBtn.classList.remove('active');
		installAppsBtn.classList.remove('active');
		btn.classList.add('active');
	}

    myAppsBtn.addEventListener('click', () => {renderApps(false); activate(myAppsBtn);});
    installAppsBtn.addEventListener('click', () => {renderApps(true); activate(installAppsBtn);});
    backupBtn.addEventListener('click', () => renderText('Backup'));
    diskBtn.addEventListener('click', () => renderText('Disk Management'));
    monitorBtn.addEventListener('click', () => renderText('Monitor'));

    vpnBtn.addEventListener('click', () => renderVPN());
    servicesBtn.addEventListener('click', () => renderServices());
    updatesBtn.addEventListener('click', () => renderUpdates());
    repositoriesBtn.addEventListener('click', () => renderRepositories());
    systemservicesBtn.addEventListener('click', () => renderSystemServices());

    closeBtn.addEventListener('click', () => {
        popup.classList.add('hidden');
    });

    popup.addEventListener('click', (event) => {
        if (event.target === popup) {
            popup.classList.add('hidden');
        }
    });

    renderApps(false);
});
</script>

<script>
    const profileSection = document.getElementById('profileSection');
    profileSection.addEventListener('click', () => {
        //TODO: profile szekcióra kattintott
    });
</script>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.6/dist/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
<script src="common.js?t=7"></script>
</body>
</html>
